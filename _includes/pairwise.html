<h1>{{ include.title }}</h1>
{{ include.content | markdownify }}

<a href="#" onclick="storeAndNext('left')">
  <div class="block">
    <div id="left_img" class="img right"></div>
    <h1 id="left_title">Empty</h1>
  </div>
</a>
<a href="#" onclick="storeAndNext('right')">
  <div class="block">
    <div id="right_img" class="img left"></div>
    <h1 id="right_title">Empty</h1>
  </div>
</a>

<div id="bottombar">
  <div id="slider"></div>
</div>

<style type="text/css">
  .block {
    width: 50%;
    float: left;
    opacity: .5;
  }

  .block:hover {
    opacity: 1;
  }

  #bottombar {
    position: absolute;
    bottom: 0px;
    width: 100%;
  }

  #slider {
    width: 5%;
    height: 10px;
    background: orange;
  }
</style>

<script>
  var animals = {{ include.questions | jsonify }}
  var combos = [];
  var count = 0;

  function calcCombos() {
    for (var i = 0; i < animals.length; i++)
      for (var j = i + 1; j < animals.length; j++)
        combos[combos.length] = [i, j]
  }

  function storeAndNext(answer) {
    var left = document.getElementById("left_title").innerHTML
    var right = document.getElementById("right_title").innerHTML

    setVal(left, right, answer)
    next()
  }

  function setContent(id, name, img, pos) {
    document.getElementById(id + "_title").innerHTML = name
    document.getElementById(id + "_img").style.backgroundImage = "url('" + img + "')";
  }

  function setVal(a, b, slider) {
    surveyResponse = ref.push();
    surveyResponse.set({
      a: a,
      b: b,
      slider: slider,
      id: id
    })
  }

  function next() {
    document.getElementById("slider").style.width = (count / combos.length) * 100 + "%";
    if (count < combos.length) {
      var curPair = combos[count]
      setContent("left", animals[curPair[0]].title, animals[curPair[0]].image, animals[curPair[0]].img_pos)

      setContent("right", animals[curPair[1]].title, animals[curPair[1]].image, animals[curPair[1]].img_pos)
      count++
    } else {
      nextPage()
    }
  }
</script>
